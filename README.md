# php-miio

Реализация взаимодействия с wifi-устройствами из экосистемы xiaomi по протоколу miIO.

miio-cli.php - интерфейс командной строки (демонстрация работы).

Принимаемые параметры:
  *	--discover all	- поиск устройств в локальной сети и вывод информации о них
  *	--discover IP   - проверка доступности конкретного устройства и вывод информации о нем
  *	--info	        - получить информацию об устройстве (аналог --discover IP)
  *	--sendcmd       - отправить команду (в linux д.б. заключена в одинарные кавычки, в windows без них)
  * --decode       -	расшифровать пакет
  *	--ip            - IP-адрес устройства
  *	--bindip		- IP-адрес интерфейса сервера (не обязательно, если интерфейс один)
  *	--token         - токен устройства (не обязательно)
  *	--debug         - включает вывод отладочной информации
  *	--help          - справка по командам

Примеры:
  *	php miio-cli.php --discover all
  *	php miio-cli.php --discover all --bindip 192.168.1.10
  *	php miio-cli.php --discover 192.168.1.45 --debug
  *	php miio-cli.php --ip 192.168.1.45 --info
  *	php miio-cli.php --ip 192.168.1.45 --sendcmd '{"method":"toggle",,"params":[],"id":1}'
  *	php miio-cli.php --ip 192.168.1.47 --sendcmd '{"id":1,"method":"get_prop","params":["power"]}'
  *	php miio-cli.php --token b31c928032e6a4afc898c5c8768a518f --decode 2131004000000000035afe...bea030

miio.class.php - класс для сетевого взаимодействия по протоколу miIO:
*	прием udp-пакетов из сокета
*	отправка udp-пакетов в сокет
*	процедура рукопожатия (handshake)
*	отправка сообщений устройству
*	прием ответов от устройства
*	поиск устройств (handshake-discovery)

mipacket.class.php - класс для работы с сетевыми udp-пакетами по протоколу miIO:
*	генерация ключа и вектора инициализации из токена
*	расшифровка
*	шифрование
*	парсинг udp-пакета
*	сборка udp-пакета
